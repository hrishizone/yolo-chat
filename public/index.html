<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="ngrok-skip-browser-warning" content="true" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>YOLO Chat</title>
    <link rel="stylesheet" href="/style.css" />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <link rel="shortcut icon" href="/favicon.png" type="image/png" />
    <meta name="description" content="Anonymous 1-to-1 chat. No sign-up." />
  </head>

  <body>
    <div class="app">
      <!-- Header -->
      <header>
        <div class="logo">
          <img src="/logo.png" alt="YOLO Chat Logo" />
        </div>
        <div class="status">
          <span id="status-dot" class="dot"></span>
          <span id="status-text">Connectingâ€¦</span>
        </div>
        <button id="modeToggle" class="mode-fab" title="Switch to Video">
          <svg
            id="videoIcon"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="currentColor"
          >
            <path
              d="M17 10.5V7a2 2 0 0 0-2-2H3a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-3.5l4 4v-11l-4 4z"
            />
          </svg>
          <svg
            id="chatIcon"
            class="hidden"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="currentColor"
          >
            <path
              d="M20 2H4a2 2 0 0 0-2 2v14l4-4h14a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"
            />
          </svg>
        </button>
      </header>

      <!-- Main Chat Area -->
      <main>
        <!-- Video Area -->
        <div id="video-area" class="video-area">
          <video id="strangerVideo" autoplay playsinline></video>
          <video id="myVideo" autoplay muted playsinline></video>

          <div class="video-controls">
            <button id="muteBtn" class="call-btn" aria-pressed="false" title="Toggle microphone">
              <svg id="micOnIcon" class="icon hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path d="M5 3a3 3 0 0 1 6 0v5a3 3 0 0 1-6 0z"/><path d="M3.5 6.5A.5.5 0 0 1 4 7v1a4 4 0 0 0 8 0V7a.5.5 0 0 1 1 0v1a5 5 0 0 1-4.5 4.975V15h3a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1h3v-2.025A5 5 0 0 1 3 8V7a.5.5 0 0 1 .5-.5"/></svg>
              <svg id="micOffIcon" class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path d="M13 8c0 .564-.094 1.107-.266 1.613l-.814-.814A4 4 0 0 0 12 8V7a.5.5 0 0 1 1 0zm-5 4c.818 0 1.578-.245 2.212-.667l.718.719a5 5 0 0 1-2.43.923V15h3a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1h3v-2.025A5 5 0 0 1 3 8V7a.5.5 0 0 1 1 0v1a4 4 0 0 0 4 4m3-9v4.879L5.158 2.037A3.001 3.001 0 0 1 11 3"/><path d="M9.486 10.607 5 6.12V8a3 3 0 0 0 4.486 2.607m-7.84-9.253 12 12 .708-.708-12-12z"/></svg>
            </button>

            <button id="camBtn" class="call-btn" aria-pressed="false" title="Toggle camera">
              <svg id="camOnIcon" class="icon hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" d="M0 5a2 2 0 0 1 2-2h7.5a2 2 0 0 1 1.983 1.738l3.11-1.382A1 1 0 0 1 16 4.269v7.462a1 1 0 0 1-1.406.913l-3.111-1.382A2 2 0 0 1 9.5 13H2a2 2 0 0 1-2-2z"/></svg>
              <svg id="camOffIcon" class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" d="M10.961 12.365a2 2 0 0 0 .522-1.103l3.11 1.382A1 1 0 0 0 16 11.731V4.269a1 1 0 0 0-1.406-.913l-3.111 1.382A2 2 0 0 0 9.5 3H4.272zm-10.114-9A2 2 0 0 0 0 5v6a2 2 0 0 0 2 2h5.728zm9.746 11.925-10-14 .814-.58 10 14z"/></svg>
            </button>

            <button id="endBtn" class="call-btn danger" title="Leave">
              <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 7c-3.31 0-6.31 1.34-8.48 3.52a1 1 0 0 0-.27 1.05l1.25 3.75a1 1 0 0 0 1.37.6l2.49-1.24a1 1 0 0 0 .53-1.07l-.37-2.19A11.36 11.36 0 0 1 12 11c1.25 0 2.46.2 3.48.57l-.37 2.19a1 1 0 0 0 .53 1.07l2.49 1.24a1 1 0 0 0 1.37-.6l1.25-3.75a1 1 0 0 0-.27-1.05A11.93 11.93 0 0 0 12 7z"/></svg>
            </button>
          </div>
        </div>

        <!-- Chat/Text Area -->
        <div id="chat-area">
          <div id="messages" class="messages" aria-live="polite"></div>

          <form id="composer" class="composer" autocomplete="off">
            <input id="message" type="text" placeholder="Type a messageâ€¦" maxlength="2000" />
            <button type="submit" id="send">Send</button>

            <!-- Command Suggestion Panel -->
            <div id="commandList" class="command-list hidden">
              <div data-cmd="/tictactoe" class="cmd-item">ðŸŽ® /tictactoe <span>Play Tic Tac Toe</span></div>
              <div data-cmd="/connect4" class="cmd-item">ðŸŸ¡ /connect4 <span>Play Connect Four</span></div>
              <div data-cmd="/help" class="cmd-item">ðŸ’¬ /help <span>Show all commands</span></div>
            </div>
          </form>
        </div>
      </main>

      <!-- Footer -->
      <footer>
        <button id="next" class="util-btn">Next</button>
        <span class="hint">Youâ€™re chatting with a random stranger. Donâ€™t share personal info.</span>
      </footer>
    </div>

    <!-- Consent Modal -->
    <div id="consentModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="consentTitle">
      <div class="modal-card">
        <div class="modal-header">
          <h3 id="consentTitle">Start a Video Chat?</h3>
        </div>
        <div class="modal-body">
          <p>The stranger wants to switch to video. Your camera and microphone will be used.</p>
          <ul class="modal-list">
            <li>Hide personal info in the frame.</li>
            <li>You can mute or stop cam anytime.</li>
          </ul>
        </div>
        <div class="modal-actions">
          <button id="consentDecline" class="btn secondary">Decline</button>
          <button id="consentAccept" class="btn primary">Accept</button>
        </div>
      </div>
    </div>

    <!-- Outgoing Request Toast -->
    <div id="requestToast" class="toast hidden" role="status" aria-live="polite">
      <span>Video request sentâ€¦ waiting for response</span>
      <button id="toastDismiss" class="toast-dismiss" title="Dismiss">âœ•</button>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script type="module" src="/client.js"></script>
  </body>
</html>
